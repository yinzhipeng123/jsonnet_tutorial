<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>调用</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>调用</h1><br/><h3>调用</h3><br /><br />self代表自己{}框起来的对象<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{<br />&nbsp;Martini:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[&quot;apple&quot;]}<br />,&#39;Gin&nbsp;Martini&#39;:&nbsp;self.Martini,<br /><br />}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;Gin&nbsp;Martini&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ingredients&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;apple&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&quot;Martini&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ingredients&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;apple&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />$表示最外面的{}，[]代表查找哪个对象<br /><br />ckey引用ekey的值<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{bkey:&quot;apple&quot;,<br />ckey:$[&#39;ekey&#39;],<br />ekey:{inita:[&quot;a&quot;],initb:[&quot;b&quot;]},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;a&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;a&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />用.表示对象内的对象<br /><br />ckey引用ekey的值的inita的值<br /><br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{bkey:&quot;apple&quot;,<br />ckey:$[&#39;ekey&#39;].inita,<br />ekey:{inita:[&quot;a&quot;],initb:[&quot;b&quot;]},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;a&quot;<br />&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;a&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />支持读取数组的第几个，用[]来给出数组的下标<br /><br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{bkey:&quot;apple&quot;,<br />ckey:$[&#39;ekey&#39;].inita[2],<br />ekey:{inita:[&quot;0&quot;,&quot;1&quot;,&quot;2&quot;],initb:[&quot;b&quot;]},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;&quot;2&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;1&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;2&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />数组的[]支持像python那样的切片取值<br />ckey取  ekey的inita数组的从下标0开始，往后数3个<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{bkey:&quot;apple&quot;,<br />ckey:$[&#39;ekey&#39;].inita[0:3],<br />ekey:{inita:[&quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;],initb:[&quot;b&quot;]},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;1&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;2&quot;<br />&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;0&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;1&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;2&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;3&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;4&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />[]对数组的操作，也可以把字符串看作数组来操作<br /><br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br />{<br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;&quot;012&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;&quot;012345&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br />}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{bkey:&quot;apple&quot;,<br />ckey:$[&#39;ekey&#39;].inita[0:3],<br />ekey:{inita:&quot;012345&quot;,initb:[&quot;b&quot;]},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;bkey&quot;:&nbsp;&quot;apple&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ckey&quot;:&nbsp;&quot;012&quot;,<br />&nbsp;&nbsp;&nbsp;&quot;ekey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;inita&quot;:&nbsp;&quot;012345&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;initb&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;b&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />可以给{}取名字，这样就方便调用了<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />{<br />&nbsp;&nbsp;Martini:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;drink&nbsp;=&nbsp;self,<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;kind:&nbsp;&quot;Farmer&#39;s&nbsp;Gin&quot;,&nbsp;qty:&nbsp;1&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;kind:&nbsp;&#39;Dry&nbsp;White&nbsp;Vermouth&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;qty:&nbsp;drink.ingredients[0].qty,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;garnish:&nbsp;&#39;Olive&#39;,<br />&nbsp;&nbsp;&nbsp;&nbsp;served:&nbsp;&#39;Straight&nbsp;Up&#39;,<br />&nbsp;&nbsp;},<br />}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;Martini&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;garnish&quot;:&nbsp;&quot;Olive&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ingredients&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;kind&quot;:&nbsp;&quot;Farmer&#39;s&nbsp;Gin&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;qty&quot;:&nbsp;1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;kind&quot;:&nbsp;&quot;Dry&nbsp;White&nbsp;Vermouth&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;qty&quot;:&nbsp;1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;served&quot;:&nbsp;&quot;Straight&nbsp;Up&quot;<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div></div>
</body>
</html>
