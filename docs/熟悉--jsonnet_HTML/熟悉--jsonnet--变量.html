<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>变量</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>变量</h1><br/><h3>变量</h3><br /><br />local关键字定义变量<br />全局变量用;结尾<br />局部变量用,结尾<br /><br />官网的原文<br />• Variables defined next to fields end with a comma (<code>,</code>).<br />• All other cases end with a semicolon (<code>;</code>).<br /><br /><br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />local&nbsp;house_rum&nbsp;=&nbsp;&#39;Banks&nbsp;Rum&#39;;<br /><br />{<br />akey:{<br />&nbsp;&nbsp;local&nbsp;pour&nbsp;=&nbsp;1.5,<br /><br />&nbsp;&nbsp;Daiquiri:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;kind:&nbsp;house_rum,&nbsp;qty:&nbsp;pour&nbsp;},]}},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="color:#000000;font-weight:400">{</span><br />&nbsp;&nbsp;&nbsp;&quot;akey&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Daiquiri&quot;:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;ingredients&quot;:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;kind&quot;:&nbsp;&quot;Banks&nbsp;Rum&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;qty&quot;:&nbsp;1.5<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;}<br /><span style="color:#000000;font-weight:400">}</span></div></div><br /><br />尝试了下局部变量用分号结尾，结果报错<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />local&nbsp;house_rum&nbsp;=&nbsp;&#39;Banks&nbsp;Rum&#39;;<br />local&nbsp;house_ruma&nbsp;=&nbsp;&#39;Banks&nbsp;Ruma&#39;;<br />local&nbsp;house_rumb&nbsp;=&nbsp;&#39;Banks&nbsp;Rumb&#39;;<br /><br />{<br />akey:{<br />&nbsp;&nbsp;local&nbsp;pour&nbsp;=&nbsp;1.5;<br /><br />&nbsp;&nbsp;Daiquiri:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;kind:&nbsp;house_rum,&nbsp;qty:&nbsp;pour&nbsp;},]}},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br />STATIC&nbsp;ERROR:&nbsp;test_a.jsonnet:7:19:&nbsp;expected&nbsp;a&nbsp;comma&nbsp;before&nbsp;next&nbsp;field.</div></div><br />全局变量用都好结尾，结果也报错<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_a.jsonnet&nbsp;<br />local&nbsp;house_rum&nbsp;=&nbsp;&#39;Banks&nbsp;Rum&#39;,<br />local&nbsp;house_ruma&nbsp;=&nbsp;&#39;Banks&nbsp;Ruma&#39;;<br />local&nbsp;house_rumb&nbsp;=&nbsp;&#39;Banks&nbsp;Rumb&#39;;<br /><br />{<br />akey:{<br />&nbsp;&nbsp;local&nbsp;pour&nbsp;=&nbsp;1.5,<br /><br />&nbsp;&nbsp;Daiquiri:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;kind:&nbsp;house_rum,&nbsp;qty:&nbsp;pour&nbsp;},]}},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_a.jsonnet&nbsp;<br />STATIC&nbsp;ERROR:&nbsp;test_a.jsonnet:2:1-6:&nbsp;expected&nbsp;token&nbsp;IDENTIFIER&nbsp;but&nbsp;got&nbsp;<span style="color:#000000;font-weight:400">(</span>local,&nbsp;&quot;local&quot;<span style="color:#000000;font-weight:400">)</span></div></div><br /><br />局部变量只在自己的{}中生效，如果调用大括号外的变量，则报错<br /><div class="codebox"><div class="codebox">[root@centos7&nbsp;jsonnet_learn]#&nbsp;cat&nbsp;test_e.jsonnet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />local&nbsp;house_rum&nbsp;=&nbsp;&#39;Banks&nbsp;Rum&#39;;<br /><br />{<br />akey:{<br />&nbsp;&nbsp;local&nbsp;pour&nbsp;=&nbsp;1.5,<br /><br />&nbsp;&nbsp;Daiquiri:&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;ingredients:&nbsp;[<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;kind:&nbsp;house_rum,&nbsp;qty:&nbsp;pour&nbsp;},],}},<br />bkey:{<br />&nbsp;&nbsp;&nbsp;mykey:pour,<br />&nbsp;&nbsp;&nbsp;},}<br />[root@centos7&nbsp;jsonnet_learn]#&nbsp;jsonnet&nbsp;test_e.jsonnet&nbsp;<br />STATIC&nbsp;ERROR:&nbsp;test_e.jsonnet:11:10-14:&nbsp;Unknown&nbsp;variable:&nbsp;pour</div></div></div>
</body>
</html>
